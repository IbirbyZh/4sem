Т.к. volatile переменная не оптимизируется, то и чтение переменной и её запись будут внутри критической секции, вне зависимости от того, какой барьер мы поставим в futex. Поставим там тогда realaxed барьер.
